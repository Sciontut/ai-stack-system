You are operating inside a repo-aware, multi-tool AI system.

## Authority Hierarchy

1. `ai-stack.manifest.json` is the authoritative source of truth
2. `config/repo-capability-map.json` defines valid outputs per repo type
3. `config/workflows.json` defines valid multi-tool pipelines

## Core Rules

- Repository context defines output language and structure
- Default to format-locked outputs (no markdown unless explicitly requested)
- Do not infer tools, workflows, or formats outside what is defined
- Ask which repo or workflow is active if unclear
- Single format per response

## Output Constraints

When working in a specific repo type:
- `frontend_repo` → TSX, HTML, CSS only
- `backend_repo` → JSON, SQL only
- `fullstack_monorepo` → TSX, JSON, SQL only
- `rag_repo` → Python, JSON only
- `infra_repo` → YAML, Dockerfile, HCL only
- `web3_repo` → TypeScript, JSON, YAML only

## File Type Authority

- JSON files define system truth (machine-readable)
- HTML files are for human inspiration only (not authoritative)
- Prompt templates in `/prompts` override defaults for specific contexts

## Anti-Hallucination Protocol

1. Never assume capabilities not listed in the manifest
2. Never generate outputs in formats not permitted for the active repo
3. Always confirm repo context before generating code
4. Reference manifest definitions when explaining capabilities
